<!DOCTYPE html>
<html>
<head>
    <title>Location Extraction Test</title>
</head>
<body>
    <h1>Location Extraction Test</h1>
    
    <!-- Test cases for the different patterns -->
    <div class="test-case">
        <h2>Sample 1: Brandenburg - City Pattern</h2>
        <div class="statistic d-flex mb-3 overflow-auto">
            <div class="flex-grow-1 text">
                Bötzower Platz, 16515 Brandenburg - Oranienburg Bötzower Platz, 16515 Brandenburg - Oranienburg
            </div>
        </div>
    </div>
    
    <div class="test-case">
        <h2>Sample 2: Duplicated Rathenow Pattern</h2>
        <div class="statistic d-flex mb-3 overflow-auto">
            <div class="flex-grow-1 text">
                14712 Brandenburg - Rathenow 14712 Brandenburg - Rathenow
            </div>
        </div>
    </div>
    
    <div class="test-case">
        <h2>Sample 3: Street, Postal, City Pattern</h2>
        <div class="statistic d-flex mb-3 overflow-auto">
            <div class="flex-grow-1 text">
                Ahornallee  26b, 15526, Bad Saarow
            </div>
        </div>
    </div>

    <script>
        // Test the extraction function
        function extractLocation() {
            const locationElements = document.querySelectorAll('.text');
            
            for (const element of locationElements) {
                const text = element?.textContent?.trim();
                if (!text) continue;
                
                console.log('Testing text:', text);
                
                // Remove duplicate patterns
                const cleanText = text.replace(/(.+?)\s+\1+$/, '$1');
                console.log('Cleaned text:', cleanText);
                
                // Pattern 1: "Brandenburg - CityName"
                const brandenburgMatch = cleanText.match(/Brandenburg\s*-\s*([^,\n\r]+)/);
                if (brandenburgMatch) {
                    console.log('Brandenburg pattern matched:', brandenburgMatch[1].trim());
                    return brandenburgMatch[1].trim();
                }
                
                // Pattern 2: "PostalCode, CityName"
                const postalCommaMatch = cleanText.match(/\d{5}\s*,\s*([^,\n\r]+)/);
                if (postalCommaMatch) {
                    console.log('Postal comma pattern matched:', postalCommaMatch[1].trim());
                    return postalCommaMatch[1].trim();
                }
                
                // Pattern 3: "Street, PostalCode CityName"
                const streetPostalMatch = cleanText.match(/^[^,]+,\s*\d{5}\s+([^,\n\r]+)$/);
                if (streetPostalMatch) {
                    console.log('Street postal pattern matched:', streetPostalMatch[1].trim());
                    return streetPostalMatch[1].trim();
                }
                
                // Pattern 4: "PostalCode CityName" at start
                const postalMatch = cleanText.match(/^\d{5}\s+([^,\n\r-]+)/);
                if (postalMatch) {
                    const city = postalMatch[1].trim();
                    if (city !== 'Brandenburg') {
                        console.log('Postal pattern matched:', city);
                        return city;
                    }
                }
                
                console.log('No pattern matched for:', text);
            }
            
            return null;
        }

        // Test all patterns
        console.log('=== Location Extraction Test ===');
        const result = extractLocation();
        console.log('Final result:', result);
    </script>
</body>
</html>